# Especificación Detallada: Blog Personal

## Información General del Proyecto

- **Nombre**: Blog Personal
- **Tecnologías**:
  - Spring Boot 3.4.3
  - Java 23
  - Maven
  - MySQL
- **Dependencias principales**:
  - Spring Web
  - Spring Data JPA
  - Spring Security
  - Lombok
  - Validation
  - MySQL Driver

## Arquitectura de la Aplicación

La aplicación sigue una arquitectura de capas con un diseño RESTful:

1. **Capa de Controladores**: Maneja las peticiones HTTP y devuelve respuestas
2. **Capa de Servicios**: Implementa la lógica de negocio
3. **Capa de Repositorios**: Gestiona el acceso a datos
4. **Capa de Modelos**: Define las entidades y sus relaciones

## Modelo de Datos

### Usuario
- **Campos**: id, nombre, apellido, email, username, password, bio, foto, fechaCreación, fechaActualización, rol (ADMIN, USER)
- **Relaciones**: 
  - One-to-Many con Post
  - One-to-Many con Comment

### Post
- **Campos**: id, título, contenido, extracto, estado (PUBLICADO, BORRADOR), fechaCreación, fechaActualización, fechaPublicación, imagen
- **Relaciones**:
  - Many-to-One con User
  - Many-to-Many con Category
  - Many-to-Many con Tag
  - One-to-Many con Comment

### Comment
- **Campos**: id, contenido, fechaCreación, fechaActualización
- **Relaciones**:
  - Many-to-One con User
  - Many-to-One con Post
  - One-to-Many consigo mismo (para respuestas a comentarios)

### Category
- **Campos**: id, nombre, descripción, slug, fechaCreación, fechaActualización
- **Relaciones**:
  - Many-to-Many con Post

### Tag
- **Campos**: id, nombre, slug, fechaCreación, fechaActualización
- **Relaciones**:
  - Many-to-Many con Post

## Funcionalidades Detalladas

### 1. Sistema de Autenticación y Autorización

- **Registro de Usuario**:
  - Captura de datos básicos (nombre, email, contraseña)
  - Validación de datos
  - Verificación de email (opcional)
  - Asignación automática de rol USER

- **Inicio de Sesión**:
  - Autenticación mediante JWT
  - Duración del token: 7 días (configurable)
  - Almacenamiento en localStorage del cliente

- **Gestión de Permisos**:
  - USER: Gestión de su propio contenido
  - ADMIN: Gestión completa del sistema

### 2. Gestión de Posts

- **Creación de Posts**:
  - Editor de texto enriquecido
  - Subida de imágenes destacadas
  - Asignación de categorías y tags
  - Opción de guardar como borrador o publicar

- **Edición de Posts**:
  - Modificación de todos los campos
  - Historial de cambios (opcional)

- **Visualización de Posts**:
  - Vista detallada con contenido completo
  - Vista resumida (lista de posts)
  - Filtrado por categoría, tag, autor

- **Eliminación de Posts**:
  - Soft delete (opcional)
  - Confirmación de eliminación

### 3. Sistema de Comentarios

- **Creación de Comentarios**:
  - Comentar en posts
  - Responder a otros comentarios
  - Editor de texto simple

- **Gestión de Comentarios**:
  - Edición de comentarios propios
  - Eliminación de comentarios propios
  - Moderación por parte del administrador

### 4. Perfil de Usuario

- **Visualización de Perfil**:
  - Datos personales
  - Foto de perfil
  - Listado de posts publicados
  - Historial de comentarios

- **Edición de Perfil**:
  - Actualización de datos personales
  - Cambio de contraseña
  - Subida de foto de perfil

### 5. Categorización y Etiquetas

- **Gestión de Categorías**:
  - Creación, edición, eliminación (solo ADMIN)
  - Asignación a posts

- **Gestión de Tags**:
  - Creación, edición, eliminación
  - Asignación a posts
  - Nube de tags

### 6. Búsqueda y Filtrado

- **Búsqueda Simple**:
  - Por título y contenido
  - Resultados paginados

- **Filtrado**:
  - Por categoría
  - Por tag
  - Por autor
  - Por fecha

## API Endpoints

### Autenticación
- `POST /api/auth/register` - Registro de usuario
- `POST /api/auth/login` - Inicio de sesión
- `POST /api/auth/refresh` - Refrescar token
- `POST /api/auth/forgot-password` - Recuperar contraseña

### Usuarios
- `GET /api/users` - Listar usuarios (ADMIN)
- `GET /api/users/{id}` - Obtener usuario
- `GET /api/users/me` - Obtener usuario actual
- `PUT /api/users/{id}` - Actualizar usuario
- `DELETE /api/users/{id}` - Eliminar usuario

### Posts
- `GET /api/posts` - Listar posts
- `GET /api/posts/{id}` - Obtener post
- `POST /api/posts` - Crear post
- `PUT /api/posts/{id}` - Actualizar post
- `DELETE /api/posts/{id}` - Eliminar post
- `GET /api/users/{id}/posts` - Obtener posts de un usuario

### Comentarios
- `GET /api/posts/{postId}/comments` - Listar comentarios de un post
- `POST /api/posts/{postId}/comments` - Crear comentario
- `PUT /api/comments/{id}` - Actualizar comentario
- `DELETE /api/comments/{id}` - Eliminar comentario
- `POST /api/comments/{id}/replies` - Responder a un comentario

### Categorías
- `GET /api/categories` - Listar categorías
- `GET /api/categories/{id}` - Obtener categoría
- `POST /api/categories` - Crear categoría (ADMIN)
- `PUT /api/categories/{id}` - Actualizar categoría (ADMIN)
- `DELETE /api/categories/{id}` - Eliminar categoría (ADMIN)
- `GET /api/categories/{id}/posts` - Obtener posts por categoría

### Tags
- `GET /api/tags` - Listar tags
- `GET /api/tags/{id}` - Obtener tag
- `POST /api/tags` - Crear tag
- `PUT /api/tags/{id}` - Actualizar tag (ADMIN)
- `DELETE /api/tags/{id}` - Eliminar tag (ADMIN)
- `GET /api/tags/{id}/posts` - Obtener posts por tag

## Seguridad

- Autenticación basada en JWT
- Encriptación de contraseñas con BCrypt
- Validación de datos en todas las entradas
- Control de acceso basado en roles
- Protección contra CSRF y XSS

## Paginación y Ordenamiento

- Implementación de paginación en todas las listas
- Parámetros estándar:
  - `page`: Número de página (0-based)
  - `size`: Tamaño de página
  - `sort`: Campo y dirección de ordenamiento

## Manejo de Errores

- Respuestas de error estructuradas
- Códigos HTTP apropiados
- Mensajes descriptivos
- Logging de errores

## Configuraciones

### Base de Datos
- URL: jdbc:mysql://localhost:3306/blogpersonal
- Modo de actualización: update
- Mostrar SQL: true
- Dialecto: MySQL8Dialect

### Servidor
- Puerto: 8080

### Seguridad JWT
- Secret: miClaveSecretaJWTDebeSerLargaYCompleja123456789
- Expiración: 604800000 ms (7 días)

### Archivos
- Tamaño máximo de archivo: 2MB
- Tamaño máximo de petición: 2MB

## Posibles Mejoras Futuras

1. **Sistema de Notificaciones**:
   - Notificaciones para nuevos comentarios
   - Notificaciones para respuestas
   - Emails de resumen

2. **Estadísticas y Analytics**:
   - Visualizaciones de posts
   - Tendencias de lectores
   - Tiempos de lectura

3. **Integración con Redes Sociales**:
   - Compartir posts
   - Login con redes sociales

4. **Sistema de "Me gusta"**:
   - Para posts y comentarios

5. **Suscripciones**:
   - A categorías
   - A usuarios
   - Newsletter

6. **Funcionalidades SEO**:
   - Meta tags personalizados
   - URLs amigables
   - Sitemap automático